<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPARQL Query Runner</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border: 1px solid #ddd;
            overflow-x: auto;
            max-height: 400px;
        }
    </style>
</head>
<body>
    <h1>SPARQL Query Runner</h1>
    <button id="runQuery">Run Query</button>
    <h2>Results:</h2>
    <pre id="results">No results yet...</pre>

    <script>
        document.getElementById('runQuery').addEventListener('click', () => {
            const endpoint = "http://localhost:9999/blazegraph/sparql";
            const query = `
                PREFIX pra: <https://maastrichtuniversity.nl/course/PRA3006/2024/assessment/>
                SELECT ?name ?species ?genus ?family ?class ?order ?phylum ?kingdom ?redlist ?trend ?animalID
                WHERE {
                    ?animalID      
                        pra:scientificName ?name ;
                        pra:kingdomName ?kingdom ;
                        pra:phylumName ?phylum ;
                        pra:orderName ?order ;
                        pra:className ?class ;
                        pra:familyName ?family ;
                        pra:genusName ?genus ;
                        pra:speciesName ?species ;
                        pra:redlistCategory ?redlist ;
                        pra:populationTrend ?trend .
                }
            `;

            const url = endpoint + "?query=" + encodeURIComponent(query);

            fetch(url, {
                method: "GET",
                headers: {
                    "Accept": "application/sparql-results+json"
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok: " + response.statusText);
                }
                return response.json();
            })
            .then(data => {
                // Parse and display results
                const bindings = data.results.bindings;
                let results = bindings.map(binding => {
                    return Object.entries(binding).map(([key, value]) => `${key}: ${value.value}`).join("\n");
                }).join("\n\n");

                document.getElementById('results').textContent = results || "No data found.";
            })
            .catch(error => {
                console.error("Error fetching SPARQL data:", error);
                document.getElementById('results').textContent = "Error: " + error.message;
            });
        });
    </script>
</body>
</html>
